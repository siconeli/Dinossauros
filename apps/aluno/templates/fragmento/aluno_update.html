{% load static %}

{% block conteudo %}
    {% if form.errors %}
        <div class="alert alert-danger" id="error" role="alert">
            Existe um ou mais campos inválidos no formulário!
        </div>
    {% endif %}
    <form id="aluno-update-form" hx-post="{% url 'aluno-update' aluno.pk %}" hx-target="#aluno-form" hx-swap="innerHTML">
        {% csrf_token %}        
        <div class="row">
            <div class="col">
                <label for="nome">Nome</label>
                <input type="text" id="nome" name="nome" disabled class="form-control form-control-sm input-update-aluno" value="{{ aluno.nome }}" maxlength="50" required>
            </div>
            <div class="col">
                <label for="cpf">CPF</label>
                <input type="text" id="cpf" name="cpf" disabled class="form-control form-control-sm input-update-aluno" value="{{ aluno.cpf }}" maxlength="11" required>
            </div>
            <div class="col">
                <label for="idade">Idade</label>
                <input type="number" id="idade" name="idade" max="100" min="1" disabled class="form-control form-control-sm input-update-aluno mb-3" value="{{ aluno.idade }}" required>
            </div>
        </div>

        <button type="button" class="btn" onclick="removeDisabled('input-update-aluno', 'salvar_aluno')">Editar</button>
        <button type="submit" class="btn" id="salvar_aluno" style="display: none;">Salvar</button>
    </form>
{% endblock %}

{% block scripts %}
    <!-- Importação para uso de mask -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>

    <script>
        $(document).ready(function() {
            $('#cpf').mask('000.000.000-00', {reverse: true}); // Máscara de CPF
        });

        function removeDisabled(className, id) {
            // Seleciona todos os elementos com a classe especificada e remove o atributo 'disabled'
            $('.' + className).removeAttr('disabled');

            // Seleciona o elemento com o id especificado e altera o estilo de exibição
            $('#' + id).css('display', 'inline');
        }

        $('form').on('submit', function() {
            // Remove a máscara de CPF ou CNPJ
            $("#cpf").unmask();
        });
    </script>
{% endblock %}
